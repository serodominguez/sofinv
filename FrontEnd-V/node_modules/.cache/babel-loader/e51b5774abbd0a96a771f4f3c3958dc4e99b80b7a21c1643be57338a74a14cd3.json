{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { createStore } from 'vuex';\nimport { jwtDecode } from 'jwt-decode';\nimport router from '@/router/index';\nimport brand from './modules/brand';\nimport category from './modules/category';\nimport goodsreceipt from './modules/goodsreceipt';\nimport product from './modules/product';\nimport role from './modules/role';\nimport store from './modules/store';\nimport supplier from './modules/supplier';\nimport user from './modules/user';\nimport warehouse from './modules/warehouse';\nconst storeJS = createStore({\n  state: {\n    token: null,\n    currentUser: null\n  },\n  getters: {\n    isAuthenticated(state) {\n      return !!state.token;\n    },\n    getCurrentUser(state) {\n      return state.currentUser;\n    }\n  },\n  mutations: {\n    setToken(state, token) {\n      state.token = token;\n    },\n    setUser(state, user) {\n      state.currentUser = user;\n    }\n  },\n  actions: {\n    saveToken({\n      commit\n    }, token) {\n      commit(\"setToken\", token);\n      commit(\"setUser\", jwtDecode(token));\n      localStorage.setItem(\"token\", token);\n    },\n    auto({\n      commit\n    }) {\n      let token = localStorage.getItem(\"token\");\n      if (token) {\n        const decodedToken = jwtDecode(token);\n        const currentTime = Date.now() / 1000; // Tiempo actual en segundos\n\n        // Verificar si el token ha expirado\n        if (decodedToken.exp < currentTime) {\n          // Si el token ha expirado, redirigir al login\n          this.logoff({\n            commit\n          });\n          return;\n        }\n        commit(\"setToken\", token);\n        commit(\"setUser \", decodedToken);\n      }\n      router.push({\n        name: \"dashboard\"\n      });\n    },\n    logoff({\n      commit\n    }) {\n      commit(\"setToken\", null);\n      commit(\"setUser\", null);\n      localStorage.removeItem(\"token\");\n      router.push({\n        name: \"login\"\n      });\n    }\n  },\n  modules: {\n    brand,\n    category,\n    goodsreceipt,\n    product,\n    role,\n    store,\n    supplier,\n    user,\n    warehouse\n  }\n});\nexport default storeJS;","map":{"version":3,"names":["createStore","jwtDecode","router","brand","category","goodsreceipt","product","role","store","supplier","user","warehouse","storeJS","state","token","currentUser","getters","isAuthenticated","getCurrentUser","mutations","setToken","setUser","actions","saveToken","commit","localStorage","setItem","auto","getItem","decodedToken","currentTime","Date","now","exp","logoff","push","name","removeItem","modules"],"sources":["C:/Users/Sergio/Desktop/SOFINV/FrontEnd/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex';\nimport { jwtDecode } from 'jwt-decode';\nimport router from '@/router/index'\nimport brand from './modules/brand';\nimport category from './modules/category';\nimport goodsreceipt from './modules/goodsreceipt';\nimport product from './modules/product';\nimport role from './modules/role';\nimport store from './modules/store';\nimport supplier from './modules/supplier';\nimport user from './modules/user';\nimport warehouse from './modules/warehouse';\n\nconst storeJS = createStore({\n  state: {\n    token: null,\n    currentUser: null,\n  },\n  getters: {\n    isAuthenticated(state) {\n      return !!state.token;\n    },\n    getCurrentUser (state) {\n      return state.currentUser ;\n    }\n  },\n  mutations: {\n    setToken(state, token) {\n      state.token = token\n    },\n    setUser(state, user) {\n      state.currentUser = user\n    }\n  },\n  actions: {\n    saveToken({ commit }, token) {\n      commit(\"setToken\", token);\n      commit(\"setUser\", jwtDecode(token));\n      localStorage.setItem(\"token\", token);\n    },\n    auto({ commit }) {\n      let token = localStorage.getItem(\"token\");\n      if (token) {\n        const decodedToken = jwtDecode(token);\n        const currentTime = Date.now() / 1000; // Tiempo actual en segundos\n  \n        // Verificar si el token ha expirado\n        if (decodedToken.exp < currentTime) {\n          // Si el token ha expirado, redirigir al login\n          this.logoff({ commit });\n          return;\n        }\n  \n        commit(\"setToken\", token);\n        commit(\"setUser \", decodedToken);\n      }\n      router.push({ name: \"dashboard\" });\n    },\n    logoff({ commit }) {\n      commit(\"setToken\", null);\n      commit(\"setUser\", null);\n      localStorage.removeItem(\"token\");\n      router.push({ name: \"login\" });\n    },\n  },\n\n  modules: {\n    brand,\n    category,\n    goodsreceipt,\n    product,\n    role,\n    store,\n    supplier,\n    user,\n    warehouse,\n  },\n});\n\nexport default storeJS;"],"mappings":";AAAA,SAASA,WAAW,QAAQ,MAAM;AAClC,SAASC,SAAS,QAAQ,YAAY;AACtC,OAAOC,MAAM,MAAM,gBAAgB;AACnC,OAAOC,KAAK,MAAM,iBAAiB;AACnC,OAAOC,QAAQ,MAAM,oBAAoB;AACzC,OAAOC,YAAY,MAAM,wBAAwB;AACjD,OAAOC,OAAO,MAAM,mBAAmB;AACvC,OAAOC,IAAI,MAAM,gBAAgB;AACjC,OAAOC,KAAK,MAAM,iBAAiB;AACnC,OAAOC,QAAQ,MAAM,oBAAoB;AACzC,OAAOC,IAAI,MAAM,gBAAgB;AACjC,OAAOC,SAAS,MAAM,qBAAqB;AAE3C,MAAMC,OAAO,GAAGZ,WAAW,CAAC;EAC1Ba,KAAK,EAAE;IACLC,KAAK,EAAE,IAAI;IACXC,WAAW,EAAE;EACf,CAAC;EACDC,OAAO,EAAE;IACPC,eAAeA,CAACJ,KAAK,EAAE;MACrB,OAAO,CAAC,CAACA,KAAK,CAACC,KAAK;IACtB,CAAC;IACDI,cAAcA,CAAEL,KAAK,EAAE;MACrB,OAAOA,KAAK,CAACE,WAAW;IAC1B;EACF,CAAC;EACDI,SAAS,EAAE;IACTC,QAAQA,CAACP,KAAK,EAAEC,KAAK,EAAE;MACrBD,KAAK,CAACC,KAAK,GAAGA,KAAK;IACrB,CAAC;IACDO,OAAOA,CAACR,KAAK,EAAEH,IAAI,EAAE;MACnBG,KAAK,CAACE,WAAW,GAAGL,IAAI;IAC1B;EACF,CAAC;EACDY,OAAO,EAAE;IACPC,SAASA,CAAC;MAAEC;IAAO,CAAC,EAAEV,KAAK,EAAE;MAC3BU,MAAM,CAAC,UAAU,EAAEV,KAAK,CAAC;MACzBU,MAAM,CAAC,SAAS,EAAEvB,SAAS,CAACa,KAAK,CAAC,CAAC;MACnCW,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEZ,KAAK,CAAC;IACtC,CAAC;IACDa,IAAIA,CAAC;MAAEH;IAAO,CAAC,EAAE;MACf,IAAIV,KAAK,GAAGW,YAAY,CAACG,OAAO,CAAC,OAAO,CAAC;MACzC,IAAId,KAAK,EAAE;QACT,MAAMe,YAAY,GAAG5B,SAAS,CAACa,KAAK,CAAC;QACrC,MAAMgB,WAAW,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC;;QAEvC;QACA,IAAIH,YAAY,CAACI,GAAG,GAAGH,WAAW,EAAE;UAClC;UACA,IAAI,CAACI,MAAM,CAAC;YAAEV;UAAO,CAAC,CAAC;UACvB;QACF;QAEAA,MAAM,CAAC,UAAU,EAAEV,KAAK,CAAC;QACzBU,MAAM,CAAC,UAAU,EAAEK,YAAY,CAAC;MAClC;MACA3B,MAAM,CAACiC,IAAI,CAAC;QAAEC,IAAI,EAAE;MAAY,CAAC,CAAC;IACpC,CAAC;IACDF,MAAMA,CAAC;MAAEV;IAAO,CAAC,EAAE;MACjBA,MAAM,CAAC,UAAU,EAAE,IAAI,CAAC;MACxBA,MAAM,CAAC,SAAS,EAAE,IAAI,CAAC;MACvBC,YAAY,CAACY,UAAU,CAAC,OAAO,CAAC;MAChCnC,MAAM,CAACiC,IAAI,CAAC;QAAEC,IAAI,EAAE;MAAQ,CAAC,CAAC;IAChC;EACF,CAAC;EAEDE,OAAO,EAAE;IACPnC,KAAK;IACLC,QAAQ;IACRC,YAAY;IACZC,OAAO;IACPC,IAAI;IACJC,KAAK;IACLC,QAAQ;IACRC,IAAI;IACJC;EACF;AACF,CAAC,CAAC;AAEF,eAAeC,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}